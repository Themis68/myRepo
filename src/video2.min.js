var media_events=new Array;media_events.loadstart=0,media_events.playing=0,media_events.timeupdate=0,media_events.currentTime=0;var timeOut=0,timeOutEffet=0,idVideoOn=0,nivZoom=1,video=[],actions=[],actionEnCours=[],isDefineBVideoJS=!1,timeCode="",avatar="",oldStep=null,myURLcomplete=document.location.href,myURL=myURLcomplete.substring(0,myURLcomplete.lastIndexOf("/")),videoNbPoint=0,stepBarre=0,stepDone=0,niveauQuest=1,idVideo=null,nbQuests=[{niv:"COURANT",nb:0,points:0},{niv:"DEBUTANT",nb:0,points:0},{niv:"CONFIRME",nb:0,points:0},{niv:"EXPERT",nb:0,points:0}],questionsFaites=[],replaysFaits=[],seqUsed=-1,hauteurContent=0,numQuestion=0,transitionTime=1e3;function user(){let avatarOk=!1;const reg=/^([a-zA-Z]){3,20}$/g;do{avatar=prompt("Indique ton prénom s'il te plait (3 à 20 lettres maximum)"),avatarOk=reg.exec(avatar)}while(!avatarOk);document.getElementById("avatar").innerHTML=avatar.toUpperCase()}function init(){var bascule;document.querySelector("bascule img").addEventListener("click",fBascule),document._video=document.getElementById("myVideo"),creerVignettes("vignettes")}function creerVignettes(id){let bloc=document.getElementById(id);for(let i=0;i<arrayAssoSize(scenario);i++){let myDiv=document.createElement("div");myDiv.className="carousel-item col-12 col-sm-6 col-md-4 col-lg-3"+(0===i?" active":"");let myImg=document.createElement("img");myImg.className="img-fluid mx-auto d-block",myImg.setAttribute("alt","img"+i),myImg.setAttribute("title","img"+i),myImg.setAttribute("src","./videos/"+(scenario[i][0].poster||"./stade.jpg"));let myCaption=document.createElement("div"),myP=document.createElement("p");myP.innerHTML=scenario[i][0].gauche.nom+"<br>"+scenario[i][0].droite.nom,myCaption.appendChild(myP),myCaption.className="carousel-caption d-none d-md-block",myCaption.setAttribute("onclick","javascript:switchVideo("+scenario[i][0].id+");"),myDiv.appendChild(myImg),myDiv.appendChild(myCaption),bloc.appendChild(myDiv)}}function fBascule(event){let carousel=document.querySelector("carousel"),span=document.querySelector("bascule span");this.src.indexOf("fermee")>0?(carousel.style.display="flex",this.src="./images/fleche_ouverte.png",span.innerHTML="cliquez sur la vignette du match que vous souhaitez arbitrer"):(carousel.style.display="none",this.src="./images/fleche_fermee.png",span.innerHTML="cliquez sur cet icône pour afficher les matchs disponibles")}function switchVideo(n){if(n>arrayAssoSize(scenario))return n=0,!1;{idVideo=n,video=scenario[n-1],idVideoOn=n,actions=video[1],listeEvents("events",media_events),setInterval(update_properties,200);let hauteur=0,matchWCalcule=0;if(isDefineBVideoJS)myVideo.src({src:"./videos/"+video[0].fichier,type:"video/mp4"}),myVideo.poster("./videos/"+video[0].poster);else{questionsFaites.splice(0,questionsFaites.length),replaysFaits.splice(0,replaysFaits.length);let match=document.querySelector("match"),carousel=document.querySelector("carousel");hauteur=match.offsetHeight+carousel.offsetHeight,myVideo=videojs("myVideo",{width:matchWCalcule=1.75*hauteur,height:hauteur,controls:!0,preload:"none",loop:!1,fluid:!0,poster:"./videos/"+video[0].poster||"./images/pelouses/pelousemini.png",controlBar:{volumePanel:{inline:!1,vertical:!0},pictureInPictureToggle:!1},sources:[{src:"./videos/"+video[0].fichier,type:"video/mp4"}],zoom:{lab:"1x",val:1},plugins:{brand:{image:myURL+"/images/EMouzmini.png",title:"club Etoile Mouzillonnaise de football",destination:"https://etoile-mouzillon.footeo.com/",destinationTarget:"_blank",width:20,height:20},videoJsZoom:{default:!0,dynamicLabel:!0,niveaux:[{lab:"2.5x",val:2.5},{lab:"2x",val:2},{lab:"1.5x",val:1.5},{lab:"1x",val:1}]},bug:[{type:"pict",id:"vjs-bug-pictEquipeA",visibility:!0,height:40,width:40,imgSrc:"./images/fanions/"+(video[0].gauche.fanion||"fff.png"),alt:video[0].droite.nom,link:"http://www.apple.fr",opacity:.7,padding:"20px",position:"tl"},{type:"text",id:"vjs-bug-titreEquipeA",visibility:!0,height:40,libelle:"<span>"+video[0].gauche.nom+"</span>",classeCSS:"vjs-bug-titreEquipBug",opacity:1,padding:"30px 70px",position:"tl"},{type:"text",id:"vjs-bug-titreEquipeB",visibility:!0,height:40,libelle:"<span>"+video[0].droite.nom+"</span>",classeCSS:"vjs-bug-titreEquipBug",opacity:1,padding:"30px 80px",position:"tr"},{type:"pict",id:"vjs-bug-pictEquipeB",visibility:!0,height:35,width:35,imgSrc:"./images/fanions/"+(video[0].droite.fanion||"fff.png"),alt:video[0].droite.nom,link:"http://www.fnac.fr",opacity:.7,padding:"20px",position:"tr"}]}})}numQuestion=0,isDefineBVideoJS=!0,myVideo.load();let inter=document.getElementById("inter");inter.offsetHeight,inter.style.display="flex",gestionCamps(1),showContent(!0),gestionInter("selectVideo")}}function listeEvents(id,arrayEventDef){for(let key in arrayEventDef)document._video.addEventListener(key,capture,!1);var e_loadstart;if(document.getElementById("e_loadstart"))for(let key in arrayEventDef){var elt;document.getElementById("e_"+key).textContent="0"}else{var tbody=document.getElementById(id),i=1,tr=null;for(let key in arrayEventDef){null==tr&&(tr=document.createElement("tr")).setAttribute("style","color:midnightblue");var th=document.createElement("th");th.textContent=key;var td=document.createElement("td");td.setAttribute("id","e_"+key),td.textContent="0",td.className="false",tr.appendChild(th),tr.appendChild(td),i++%5==0&&(tbody.appendChild(tr),tr=null)}null!=tr&&tbody.appendChild(tr)}}function capture(event){if("timeupdate"===event.type){var seq=Math.trunc(document._video.currentTime);if(seq!==seqUsed)if(seqUsed=seq,seq<oldStep);else{timeCode=convertInTimeCode(seq);var asWork=arrayAssoSearch(actions,timeCode);if(asWork>-1)switch(actions[asWork].act){case"Question":case"Bonus":case"Information":case"AllerA":actions[asWork].niveau===nbQuests[niveauQuest].niv&&mesActions[actions[asWork].act](asWork);break;case"Fin":case"Mitemps":mesActions[actions[asWork].act](asWork)}}media_events.currentTime=seq,media_events.playing=1}else media_events.playing=0;media_events[event.type]++,oldStep=seq}function update_properties(){for(let key in media_events){var e=document.getElementById("e_"+key);e&&(e.textContent=media_events[key],media_events[key]>0&&(e.className="true"))}}function getVideo(){return document._video}function gestionCamps(mitemps){2===mitemps&&(document.getElementById("vjs-bug-pictEquipeA").src=myURL+"/images/fanions/"+(video[0].droite.fanion||"fff.png"),document.getElementById("vjs-bug-pictEquipeB").src=myURL+"/images/fanions/"+(video[0].gauche.fanion||"fff.png"))}function showContent(etat){let carousel=document.getElementById("carousel"),myVideo=document.getElementById("myVideo"),bascule_img,bascule_titre;carousel.style.display=!0===etat?"none":"flex",document.querySelector("bascule img").setAttribute("src","./images/"+(!0===etat?"fleche_fermee.png":"fleche_ouverte.png")),document.querySelector("bascule span").innerHTML=!0===etat?"cliquez sur cet icône pour afficher les matchs disponibles":"cliquez sur la vignette du match que vous souhaitez arbitrer",myVideo.style.visibility="visible",myVideo.classList.add("cadre")}function scanQuestion(){nbQuests[1].nb=0,nbQuests[2].nb=0,nbQuests[3].nb=0,nbQuests[1].points=0,nbQuests[2].points=0,nbQuests[3].points=0;let niv=0;for(let ind=0;ind<arrayAssoSize(actions);ind++)if("Question"===actions[ind].act){switch(actions[ind].niveau){case"DEBUTANT":niv=1;break;case"CONFIRME":niv=2;break;case"EXPERT":niv=3;break;default:niv=0}nbQuests[niv].nb++,nbQuests[niv].points+=actions[ind].reponse.points}return document.getElementById("level1").style.display=nbQuests[1].nb>0?"flex":"none",document.getElementById("level2").style.display=nbQuests[2].nb>0?"flex":"none",document.getElementById("level3").style.display=nbQuests[3].nb>0?"flex":"none",nbQuests}document.addEventListener("DOMContentLoaded",init,!1);