<<<<<<< HEAD
var media_events=new Array;media_events.loadstart=0,media_events.playing=0,media_events.timeupdate=0,media_events.currentTime=0;var timeOut=0,timeOutEffet=0,idVideoOn=0,nivZoom=1,video=[],scripts=[],actions=[],actionEnCours=[],isDefineBVideoJS=!1,timeCode="",avatar="",oldStep=null,myURLcomplete=document.location.href,myURL=myURLcomplete.substring(0,myURLcomplete.lastIndexOf("/")),videoNbPoint=0,stepBarre=0,stepDone=0,niveauQuest=1,idVideo=null,nbQuests=[{niv:"COURANT",nb:0,points:0},{niv:"DEBUTANT",nb:0,points:0},{niv:"CONFIRME",nb:0,points:0},{niv:"EXPERT",nb:0,points:0}],questionsFaites=[],replaysFaits=[],seqUsed=-1,hauteurContent=0,numQuestion=0,transitionTime=1e3,volumeLevel=1,tabMessages=["cliquez sur la vignette du match que vous souhaitez visonner","cliquez sur cet icône pour afficher les matchs disponibles","Vous allez visionner le match avec ","Cliquez sur le bouton Play sur la vidéo pour déclencher le visionnage du match","Vous venez de terminer l'analyse arbitrale","Sélectionnez un nouveau match ou un nouveau niveau"],pathImages="../images/",pathVideos="../rencontres/",pathFanions=pathImages+"fanions/";function central(event){var target;"vjs-icon-placeholder"==(event.target||event.srcElement).getAttribute("class")&&(draw("vjs-bug-silhEquipeA",video[0].gauche.maillotCouleur),draw("vjs-bug-silhEquipeB",video[0].droite.maillotCouleur),draw("vjs-bug-silhArbitre",video[0].arbitre.maillotCouleur),document.getElementsByClassName("vjs-control-bar")[0].children[0].classList.add("vjs-hidden"),document.getElementsByClassName("vjs-control-bar")[0].children[5].classList.add("vjs-hidden"))}function init(){var bascule;document.querySelector("bascule img").addEventListener("click",fBascule),document._video=document.getElementById("myVideo"),creerVignettes("vignettes")}function draw(id,maillotCouleur){let canvas=document.getElementById(id);if(canvas.getContext){let ctx=canvas.getContext("2d");ctx.beginPath(),ctx.lineWidth="1",ctx.arc(14,14,14,0,2*Math.PI),ctx.fillStyle="black",ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.lineWidth="1",ctx.arc(14,8,5,0,2*Math.PI),ctx.fillStyle=maillotCouleur,ctx.fill(),ctx.closePath();let rectWidth=18,rectHeight=8,rectX=5,rectY=15,cornerRadius=5;ctx.beginPath(),ctx.fillStyle=maillotCouleur,ctx.lineWidth=1,ctx.moveTo(rectX+cornerRadius,rectY),ctx.lineTo(rectX+rectWidth-cornerRadius,rectY),ctx.arcTo(rectX+rectWidth,rectY,rectX+rectWidth,rectY+cornerRadius,cornerRadius),ctx.lineTo(rectX+rectWidth,rectY+rectHeight),ctx.lineTo(rectX,rectY+rectHeight),ctx.lineTo(rectX,rectY+cornerRadius),ctx.arcTo(rectX,rectY,rectX+cornerRadius,rectY,cornerRadius),ctx.fill(),ctx.closePath()}}function creerVignettes(id){let ind=document.getElementById("indicateurs");for(let i=0;i<arrayAssoSize(scenario);i++){let myInd=document.createElement("li");myInd.setAttribute("data-target","#carousel-example"),myInd.setAttribute("data-slide-to",i),0===i?myInd.setAttribute("class","active cercle"):myInd.setAttribute("class","cercle"),ind.appendChild(myInd)}let bloc=document.getElementById(id);for(let i=0;i<arrayAssoSize(scenario);i++){let myDiv=document.createElement("div");myDiv.className="carousel-item col-12 col-sm-6 col-md-4 col-lg-3"+(0===i?" active":"");let myImg=document.createElement("img");myImg.className="img-fluid mx-auto d-block",myImg.setAttribute("alt","img"+i),myImg.setAttribute("title","img"+i),myImg.setAttribute("src",pathVideos+(scenario[i][0].poster||pathImages+"pelouses/stade.jpg"));let myCaption=document.createElement("div"),myF=document.createElement("img");myF.className="carouselFanion",myF.setAttribute("title","fanionG"+i),myF.setAttribute("src",pathFanions+(scenario[i][0].gauche.fanion||"fff.png'")),myCaption.appendChild(myF),myF=document.createElement("img"),myF.className="carouselFanion",myF.setAttribute("title","fanionD"+i),myF.setAttribute("src",pathFanions+(scenario[i][0].droite.fanion||"fff.png'")),myCaption.appendChild(myF);let myP=document.createElement("p");myP.innerHTML=scenario[i][0].gauche.nom+"<br>"+scenario[i][0].droite.nom,myCaption.appendChild(myP),myCaption.className="carousel-caption d-none d-md-block",myCaption.setAttribute("onclick","javascript:switchVideo("+(i+1)+");"),myCaption.setAttribute("title",scenario[i][0].rencontre),myCaption.setAttribute("alt",scenario[i][0].rencontre),myDiv.appendChild(myImg),myDiv.appendChild(myCaption),bloc.appendChild(myDiv);let myScript=document.createElement("SCRIPT");myScript.setAttribute("type","text/javascript"),myScript.setAttribute("src","../rencontres/"+scenario[i][0].scenario),document.head.appendChild(myScript)}}function fBascule(event){let carousel=document.querySelector("carousel"),span=document.querySelector("bascule span");this.src.indexOf("fermee")>0?(carousel.style.display="flex",this.src=pathImages+"fleche_ouverte.png",this.alt="affiche la liste des matchs",span.innerHTML=avatar+" "+tabMessages[0]):(carousel.style.display="none",this.src=pathImages+"fleche_fermee.png",this.alt="masque la liste des matchs",span.innerHTML=avatar+" "+tabMessages[1])}function switchVideo(n){if(n>arrayAssoSize(scenario))return n=0,!1;{idVideo=n,video=scenario[n-1],idVideoOn=n,actions=eval(video[0].variable),listeEvents("events",media_events),setInterval(update_properties,200);let hauteur=0,matchWCalcule=0;if(isDefineBVideoJS)myVideo.src({src:pathVideos+video[0].fichier,type:"video/mp4"}),myVideo.poster(pathVideos+video[0].poster);else{questionsFaites.splice(0,questionsFaites.length),replaysFaits.splice(0,replaysFaits.length);let match=document.querySelector("match"),carousel=document.querySelector("carousel");hauteur=match.offsetHeight+carousel.offsetHeight,matchWCalcule=1.75*hauteur,myVideo=videojs("myVideo",{disableVideoPlayPauseClick:!0,width:matchWCalcule,height:hauteur,controls:!0,preload:"none",loop:!1,fluid:!0,poster:pathVideos+video[0].poster||pathImages+"pelouses/pelousemini.png",controlBar:{volumePanel:{inline:!1,vertical:!0},pictureInPictureToggle:!1},sources:[{src:pathVideos+video[0].fichier,type:"video/mp4"}],zoom:{lab:"1x",val:1},plugins:{brand:{image:pathImages+"isamini.png",title:"Arrêt sur image!",destination:"asi.html",destinationTarget:"_blank",width:20,height:20},videoJsZoom:{default:!0,dynamicLabel:!0,niveaux:[{lab:"2.5x",val:2.5},{lab:"2x",val:2},{lab:"1.5x",val:1.5},{lab:"1x",val:1}]},bug:[{type:"pict",id:"vjs-bug-pictEquipeA",visibility:!0,height:30,width:30,imgSrc:pathImages+"fanions/"+(video[0].gauche.fanion||"fff.png"),alt:video[0].gauche.nom||"fanion par défaut",link:video[0].gauche.site,opacity:.7,left:"20px",top:"20px",position:"tl"},{type:"text",id:"vjs-bug-titreEquipeA",visibility:!0,libelle:"<span>"+video[0].gauche.nom+"</span>",classeCSS:"vjs-bug-titreEquipBug",opacity:1,left:"55px",top:"25px",position:"tl"},{type:"canvas",id:"vjs-bug-silhEquipeA",visibility:!0,height:30,width:30,classeCSS:"vjs-bug-silhEquipBug",opacity:1,left:"215px",top:"20px",position:"tl"},{type:"canvas",id:"vjs-bug-silhArbitre",visibility:!0,height:30,width:30,classeCSS:"vjs-bug-silhArbitreBug",opacity:1,left:"415px",top:"20px",position:"tc"},{type:"text",id:"vjs-bug-titreArbitre",visibility:!0,libelle:"<span>"+avatar+"</span>",classeCSS:"vjs-bug-titreArbitre",opacity:1,left:"415px",top:"50px",position:"tr"},{type:"canvas",id:"vjs-bug-silhEquipeB",visibility:!0,height:30,width:30,classeCSS:"vjs-bug-silhEquipBug",opacity:1,right:"225px",top:"20px",position:"tr"},{type:"text",id:"vjs-bug-titreEquipeB",visibility:!0,libelle:"<span>"+video[0].droite.nom+"</span>",classeCSS:"vjs-bug-titreEquipBug",opacity:1,right:"55px",top:"25px",position:"tr"},{type:"pict",id:"vjs-bug-pictEquipeB",visibility:!0,height:30,width:30,imgSrc:pathImages+"fanions/"+(video[0].droite.fanion||"fff.png"),alt:video[0].droite.nom||"fanion par défaut",link:video[0].droite.site,opacity:.7,right:"20px",top:"20px",position:"tr"}]}})}numQuestion=0,isDefineBVideoJS=!0,myVideo.load();let inter=document.getElementById("inter");inter.offsetHeight,inter.style.display="flex",gestionCamps(1),showContent(!0),gestionInter("selectVideo")}}function listeEvents(id,arrayEventDef){for(let key in arrayEventDef)document._video.addEventListener(key,capture,!1);var e_loadstart;if(document.getElementById("e_loadstart"))for(let key in arrayEventDef){var elt;document.getElementById("e_"+key).textContent="0"}else{var tbody=document.getElementById(id),i=1,tr=null;for(let key in arrayEventDef){null==tr&&(tr=document.createElement("tr")).setAttribute("style","color:midnightblue");var th=document.createElement("th");th.textContent=key;var td=document.createElement("td");td.setAttribute("id","e_"+key),td.textContent="0",td.className="false",tr.appendChild(th),tr.appendChild(td),i++%5==0&&(tbody.appendChild(tr),tr=null)}null!=tr&&tbody.appendChild(tr)}}function capture(event){if("timeupdate"===event.type){var seq=Math.trunc(document._video.currentTime);if(seq!==seqUsed)if(seqUsed=seq,seq<oldStep);else{timeCode=convertInTimeCode(seq);var asWork=arrayAssoSearch(actions,timeCode);if(asWork>-1)switch(actions[asWork].act){case"Question":case"Bonus":case"Information":case"AllerA":actions[asWork].niveau===nbQuests[niveauQuest].niv&&mesActions[actions[asWork].act](asWork);break;case"Fin":case"Mitemps":mesActions[actions[asWork].act](asWork)}}media_events.currentTime=seq,media_events.playing=1}else media_events.playing=0;media_events[event.type]++,oldStep=seq}function update_properties(){for(let key in media_events){var e=document.getElementById("e_"+key);e&&(e.textContent=media_events[key],media_events[key]>0&&(e.className="true"))}}function getVideo(){return document._video}function gestionCamps(mitemps){2===mitemps&&(document.getElementById("vjs-bug-titreEquipeA").innerHTML="<span>"+video[0].droite.nom+"</span>",document.getElementById("vjs-bug-titreEquipeB").innerHTML="<span>"+video[0].gauche.nom+"</span>",document.getElementById("vjs-bug-pictEquipeA").setAttribute("src",pathImages+"fanions/"+(video[0].droite.fanion||"fff.png")),document.getElementById("vjs-bug-pictEquipeB").setAttribute("src",pathImages+"fanions/"+(video[0].gauche.fanion||"fff.png")),draw("vjs-bug-silhEquipeA",video[0].droite.maillotCouleur),draw("vjs-bug-silhEquipeB",video[0].gauche.maillotCouleur))}function showContent(etat){let carousel=document.getElementById("carousel"),myVideo=document.getElementById("myVideo"),bascule_img,bascule_titre;carousel.style.display=!0===etat?"none":"flex",document.querySelector("bascule img").setAttribute("src",pathImages+(!0===etat?"fleche_fermee.png":"fleche_ouverte.png")),document.querySelector("bascule span").innerHTML=avatar+" "+(!0===etat?tabMessages[1]:tabMessages[0]),myVideo.style.visibility="visible",myVideo.classList.add("cadre")}function scanQuestion(){nbQuests[1].nb=0,nbQuests[2].nb=0,nbQuests[3].nb=0,nbQuests[1].points=0,nbQuests[2].points=0,nbQuests[3].points=0;let niv=0;for(let ind=0;ind<arrayAssoSize(actions);ind++)if("Question"===actions[ind].act){switch(actions[ind].niveau){case"DEBUTANT":niv=1;break;case"CONFIRME":niv=2;break;case"EXPERT":niv=3;break;default:niv=0}nbQuests[niv].nb++,nbQuests[niv].points+=actions[ind].reponse.points}return document.getElementById("level1").style.display=nbQuests[1].nb>0?"flex":"none",document.getElementById("level2").style.display=nbQuests[2].nb>0?"flex":"none",document.getElementById("level3").style.display=nbQuests[3].nb>0?"flex":"none",nbQuests}document.addEventListener("DOMContentLoaded",init,!1),document.addEventListener("click",central,!1);var mesActions={Question:function(ind){document._video.pause(),gestionInter("InterQuestion",actionEnCours=actions[ind])},Bonus:function(ind){document._video.pause(),gestionInter("InterBonus",actionEnCours=actions[ind])},Information:function(ind){"but"===(actionEnCours=actions[ind]).type&&playSound("goal"),gestionInter("InterInformation",actionEnCours)},AllerA:function(ind){allerA((actionEnCours=actions[ind]).indice)},Fin:function(ind){gestionInter("Termine",actionEnCours=actions[ind])},Mitemps:function(ind){actionEnCours=actions[ind],gestionCamps(2)}};function convertInSeqCode(myTimeCode){var seqTab=myTimeCode.split(":"),seq=3600*parseFloat(seqTab[0]);return seq+=60*parseFloat(seqTab[1]),seq+=parseFloat(seqTab[2])}function continuer2(){document.querySelector("inter suite next img").style.display="none","Question"===actionEnCours.act&&(numQuestion++,gestJauge()),document._video.playbackRate=1,document._video.volume=volumeLevel,classId("del","myVideo","vjs-blurOn"),classId("add","myVideo","vjs-blurOff"),document._video.play(),void 0!==actionEnCours.saut?timeOut=setTimeout(gestionInter,1500*actionEnCours.saut.attente,"FermeInfo",actionEnCours):gestionInter("FermeInfo",actionEnCours)}function fProposition(reponse){let bonneReponse=actionEnCours.reponse.solution;bonneReponse===reponse?(playSound("bonne"),classId("add","proposition"+reponse,"green"),questionsFaites.indexOf(actionEnCours.step)<0&&(addScore(actionEnCours.reponse.points),questionsFaites.push(actionEnCours.step))):(playSound("mauvaise"),classId("add","proposition"+reponse,"rouge"),classId("add","proposition"+bonneReponse,"green")),document.getElementById("loi"+bonneReponse).style.display="flex",gestPropositions("bloquer",actionEnCours.attributs),gestionInter("reponse",actionEnCours)}function allerA(indice){timeOutEffet=setTimeout(endTimeOut,500,indice),classId("del","myVideo","vjs-blurOff"),classId("add","myVideo","vjs-blurOn")}function endTimeOut(indice){getVideo().currentTime=convertInSeqCode(indice),classId("del","myVideo","vjs-blurOn"),classId("add","myVideo","vjs-blurOff"),clearTimeout(timeOutEffet)}function gestJauge(){let pourCent=0,jauge=document.getElementsByClassName("progress-bar");0==numQuestion?(jauge[0].setAttribute("aria-valuenow",0),jauge[0].setAttribute("style","width: 0%"),jauge[0].innerHTML=nbQuests[niveauQuest].nb+" Question"+(nbQuests[niveauQuest].nb>1?"s":"")):(jauge[0].setAttribute("aria-valuenow",numQuestion),pourCent=numQuestion/nbQuests[niveauQuest].nb*100,jauge[0].setAttribute("style","width: "+pourCent+"%"),jauge[0].innerHTML=numQuestion)}function fReplay(param){addScore(-1),replaysFaits.push(actionEnCours.step),getVideo().currentTime=getVideo().currentTime-param,document._video.playbackRate=.2,volumeLevel=document._video.volume,document._video.volume=0,classId("del","myVideo","vjs-blurOn"),classId("add","myVideo","vjs-blurOff"),document._video.play()}function addScore(value){0===value?videoNbPoint=0:videoNbPoint+=value;var score=("0"+videoNbPoint.toString()).substr(-2),scoreMax=("0"+nbQuests[niveauQuest].points.toString()).substr(-2);let myColor,myScore='<span style="color:'+(videoNbPoint/nbQuests[niveauQuest].points>.5?"green":"black")+';">'+score+"</span>";document.querySelector("inter suite score p").innerHTML=myScore+":"+scoreMax}function convertInTimeCode(myStep){var step=myStep,heures=Math.trunc(step/3600);step-=3600*heures;var minutes=Math.trunc(step/60),secondes=Math.trunc(step-60*minutes);return timeCode=("0"+heures).substr(-2)+":"+("0"+minutes).substr(-2)+":"+("0"+secondes).substr(-2)}function fNiveaux(level,idVideo){clearTimeout(timeOutEffet),niveauQuest=level,switchVideo(idVideo)}function gestNiveaux(idVideo){deleteChild("inter tete niveau button");let button=document.querySelector("inter tete niveau button"),span=document.createElement("span");for(let i=0;i<3;i++)span.id="level"+(i+1),span.className=i+1===niveauQuest?"badge badge-current badge-light":"badge badge-light",span.setAttribute("onclick","fNiveaux("+(i+1)+","+idVideo+");"),span.setAttribute("title",nbQuests[i+1].niv),span.setAttribute("alt",nbQuests[i+1].niv),span.innerHTML=i+1,button.appendChild(span),span=document.createElement("span")}function gestPropositions(etape,attributs,reponse){let propositions=document.querySelector("inter propositions"),proposition=document.createElement("proposition"),loi=document.createElement("a"),i=document.createElement("i"),button=document.createElement("button");switch(etape){case"afficher":deleteChild("inter propositions");for(let i=0;i<attributs.length;i++)proposition.id="proposition-div-"+(i+1),loi.id="loi"+(i+1),void 0!==actionEnCours.reponse.loi?(loi.href="../lois/"+actionEnCours.reponse.loi+".pdf",loi.target="_blank",i.id="book"+(i+1),i.className="fas fa-book",loi.innerHTML='<i class="fas fa-book"></i>'):loi.innerHTML="",loi.setAttribute("style","display:none"),proposition.appendChild(loi),button.id="proposition"+(i+1),button.className="btn btn-warning",button.innerHTML=attributs[i],questionsFaites.indexOf(actionEnCours.step)<0&&button.setAttribute("onclick","fProposition("+(i+1)+");"),proposition.appendChild(button),propositions.appendChild(proposition),button=document.createElement("button"),loi=document.createElement("a"),proposition=document.createElement("proposition");document.querySelector("inter complement p").innerHTML=reponse.libelle;break;case"bloquer":for(let i=0;i<attributs.length;i++)document.getElementById("proposition"+(i+1)).removeAttribute("onClick")}}function gestionInter(etape,objet){let inter=document.querySelector("inter");switch(etape){case"selectVideo":document.querySelector("inter jauge div").style.display="flex",document.querySelector("inter tete titre p").innerHTML="Match",document.querySelector("inter tete points").style.display="none",gestNiveaux(idVideoOn),scanQuestion(),gestJauge(),document.querySelector("inter question p").style.display="flex",document.querySelector("inter question p").innerHTML=video[0].description,document.querySelector("inter propositions").style.display="none",document.querySelector("inter complement").style.display="flex",document.querySelector("inter complement p").innerHTML=tabMessages[2]+(nbQuests[niveauQuest].nb>1?"des questions":"une question")+" de niveau "+nbQuests[niveauQuest].niv+".<br><br>"+tabMessages[3],document.querySelector("inter complement img").style.display="none",document.querySelector("inter suite replay span").style.display="none",document.querySelector("inter suite score p").style.display="none",addScore(0),document.querySelector("inter suite next img").style.display="none";break;case"FermeInfo":document.querySelector("inter tete titre p").innerHTML="Match",document.querySelector("inter tete points").style.display="none",document.querySelector("inter question p").style.display="none",document.querySelector("inter propositions").style.display="none",document.querySelector("inter complement").style.display="none",document.querySelector("inter suite replay span").style.display="none",document.querySelector("inter suite score p").style.display="flex",allerA(objet.saut.indice);break;case"InterQuestion":document.querySelector("inter tete titre p").innerHTML=objet.act,document.querySelector("inter tete points").style.display="flex",classSelector("set","inter tete points p",objet.act),document.querySelector("inter tete points p").innerHTML="0"+objet.reponse.points,gestJauge(),document.querySelector("inter question p").style.display="flex",document.querySelector("inter question p").innerHTML=objet.question.libelle,gestPropositions("afficher",objet.attributs,objet.reponse),document.querySelector("inter propositions").style.display="flex",document.querySelector("inter complement").style.display="none",replaysFaits.indexOf(objet.step)<0?(document.querySelector("inter suite replay span").style.display=objet.question.reculReplay?"flex":"none",document.querySelector("inter suite replay span").innerHTML=objet.question.reculReplay,document.querySelector("inter suite replay span").setAttribute("onclick","fReplay("+objet.question.reculReplay+");")):document.querySelector("inter suite replay span").style.display="none",document.querySelector("inter suite score p").style.display="flex",document.querySelector("inter suite next img").style.display="none";break;case"InterBonus":document.querySelector("inter tete titre p").innerHTML=objet.act,document.querySelector("inter tete points").style.display="flex",classSelector("set","inter tete points p",objet.act),document.querySelector("inter tete points p").innerHTML="0"+objet.reponse.points,document.querySelector("inter question p").style.display="flex",document.querySelector("inter question p").innerHTML=objet.question.libelle,gestPropositions("afficher",objet.attributs,objet.reponse),document.querySelector("inter propositions").style.display="flex",document.querySelector("inter complement").style.display="none",document.querySelector("inter suite replay span").style.display="none",document.querySelector("inter suite score p").style.display="flex",document.querySelector("inter suite next img").style.display="none";break;case"InterInformation":document.querySelector("inter tete titre p").innerHTML=objet.act,document.querySelector("inter tete points").style.display="none",document.querySelector("inter question p").style.display="flex",document.querySelector("inter question p").innerHTML=objet.libelle,document.querySelector("inter propositions").style.display="none",document.querySelector("inter complement").style.display="none",document.querySelector("inter suite replay span").style.display="none",document.querySelector("inter suite score p").style.display="flex",document.querySelector("inter suite next img").style.display="none",timeOut=setTimeout(gestionInter,1e3*objet.saut.attente,"FermeInfo",objet);break;case"reponse":void 0===objet.reponse.libelle&&void 0===objet.reponse.pict?document.querySelector("inter complement").style.display="none":(document.querySelector("inter complement").style.display="flex",document.querySelector("inter complement p").style.display=void 0===objet.reponse.libelle?"none":"flex",document.querySelector("inter complement img").style.display=void 0===objet.reponse.pict?"none":"flex",void 0!==objet.reponse.pict&&document.querySelector("inter complement img").setAttribute("src",pathImages+objet.reponse.pict)),void 0!==document.querySelector("inter suite replay span")&&(document.querySelector("inter suite replay span").style.display="none"),document.querySelector("inter suite score p").style.display="flex",document.querySelector("inter suite next img").style.display="flex";break;case"Termine":document.querySelector("inter tete titre p").innerHTML="Match Terminé",document.querySelector("inter jauge div").style.display="none",document.querySelector("inter tete points").style.display="none",document.querySelector("inter question p").style.display="none",document.querySelector("inter propositions").style.display="none",document.querySelector("inter complement").style.display="flex",document.querySelector("inter complement").innerHTML=tabMessages[4]+"<br>"+tabMessages[5],document.querySelector("inter suite replay span").style.display="none",document.querySelector("inter suite score p").style.display="flex";break;default:inter.display="none"}}
=======
var media_events=new Array;media_events.loadstart=0,media_events.playing=0,media_events.timeupdate=0,media_events.currentTime=0;var timeOut=0,timeOutEffet=0,idVideoOn=0,nivZoom=1,video=[],scripts=[],actions=[],actionEnCours=[],isDefineBVideoJS=!1,timeCode="",avatar="",oldStep=null,myURLcomplete=document.location.href,myURL=myURLcomplete.substring(0,myURLcomplete.lastIndexOf("/")),videoNbPoint=0,stepBarre=0,stepDone=0,niveauQuest=1,idVideo=null,nbQuests=[{niv:"COURANT",nb:0,points:0},{niv:"DEBUTANT",nb:0,points:0},{niv:"CONFIRME",nb:0,points:0},{niv:"EXPERT",nb:0,points:0}],questionsFaites=[],replaysFaits=[],seqUsed=-1,hauteurContent=0,numQuestion=0,transitionTime=1e3,volumeLevel=1,tabMessages=["cliquez sur la vignette du match que vous souhaitez visonner","cliquez sur cet icône pour afficher les matchs disponibles","Vous allez visionner le match avec ","Cliquez sur le bouton Play sur la vidéo pour déclencher le visionnage du match","Vous venez de terminer l'analyse arbitrale","Sélectionnez un nouveau match ou un nouveau niveau"],pathImages="../images/",pathVideos="../rencontres/",pathFanions=pathImages+"fanions/";function central(event){var target;"vjs-icon-placeholder"==(event.target||event.srcElement).getAttribute("class")&&(draw("vjs-bug-silhEquipeA",video[0].gauche.maillotCouleur),draw("vjs-bug-silhEquipeB",video[0].droite.maillotCouleur),draw("vjs-bug-silhArbitre",video[0].arbitre.maillotCouleur),document.getElementsByClassName("vjs-control-bar")[0].children[0].classList.add("vjs-hidden"),document.getElementsByClassName("vjs-control-bar")[0].children[5].classList.add("vjs-hidden"))}function init(){var bascule;footer(),document.querySelector("bascule img").addEventListener("click",fBascule),document._video=document.getElementById("myVideo"),creerVignettes("vignettes")}function draw(id,maillotCouleur){let canvas=document.getElementById(id);if(canvas.getContext){let ctx=canvas.getContext("2d");ctx.beginPath(),ctx.lineWidth="1",ctx.arc(14,14,14,0,2*Math.PI),ctx.fillStyle="black",ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.lineWidth="1",ctx.arc(14,8,5,0,2*Math.PI),ctx.fillStyle=maillotCouleur,ctx.fill(),ctx.closePath();let rectWidth=18,rectHeight=8,rectX=5,rectY=15,cornerRadius=5;ctx.beginPath(),ctx.fillStyle=maillotCouleur,ctx.lineWidth=1,ctx.moveTo(rectX+cornerRadius,rectY),ctx.lineTo(rectX+rectWidth-cornerRadius,rectY),ctx.arcTo(rectX+rectWidth,rectY,rectX+rectWidth,rectY+cornerRadius,cornerRadius),ctx.lineTo(rectX+rectWidth,rectY+rectHeight),ctx.lineTo(rectX,rectY+rectHeight),ctx.lineTo(rectX,rectY+cornerRadius),ctx.arcTo(rectX,rectY,rectX+cornerRadius,rectY,cornerRadius),ctx.fill(),ctx.closePath()}}function creerVignettes(id){let ind=document.getElementById("indicateurs");for(let i=0;i<arrayAssoSize(scenario);i++){let myInd=document.createElement("li");myInd.setAttribute("data-target","#carousel-example"),myInd.setAttribute("data-slide-to",i),0===i?myInd.setAttribute("class","active cercle"):myInd.setAttribute("class","cercle"),ind.appendChild(myInd)}let bloc=document.getElementById(id);for(let i=0;i<arrayAssoSize(scenario);i++){let myDiv=document.createElement("div");myDiv.className="carousel-item col-12 col-sm-6 col-md-4 col-lg-3"+(0===i?" active":"");let myImg=document.createElement("img");myImg.className="img-fluid mx-auto d-block",myImg.setAttribute("alt","img"+i),myImg.setAttribute("title","img"+i),myImg.setAttribute("src",pathVideos+(scenario[i][0].poster||pathImages+"pelouses/stade.jpg"));let myCaption=document.createElement("div"),myF=document.createElement("img");myF.className="carouselFanion",myF.setAttribute("title","fanionG"+i),myF.setAttribute("src",pathFanions+(scenario[i][0].gauche.fanion||"fff.png'")),myCaption.appendChild(myF),myF=document.createElement("img"),myF.className="carouselFanion",myF.setAttribute("title","fanionD"+i),myF.setAttribute("src",pathFanions+(scenario[i][0].droite.fanion||"fff.png'")),myCaption.appendChild(myF);let myP=document.createElement("p");myP.innerHTML=scenario[i][0].gauche.nom+"<br>"+scenario[i][0].droite.nom,myCaption.appendChild(myP),myCaption.className="carousel-caption d-none d-md-block",myCaption.setAttribute("onclick","javascript:switchVideo("+scenario[i][0].id+");"),myCaption.setAttribute("title",scenario[i][0].rencontre),myCaption.setAttribute("alt",scenario[i][0].rencontre),myDiv.appendChild(myImg),myDiv.appendChild(myCaption),bloc.appendChild(myDiv);let myScript=document.createElement("SCRIPT");myScript.setAttribute("type","text/javascript"),myScript.setAttribute("src","../rencontres/"+scenario[i][0].scenario),document.head.appendChild(myScript)}}function fBascule(event){let carousel=document.querySelector("carousel"),span=document.querySelector("bascule span");this.src.indexOf("fermee")>0?(carousel.style.display="flex",this.src=pathImages+"fleche_ouverte.png",this.alt="affiche la liste des matchs",span.innerHTML=avatar+" "+tabMessages[0]):(carousel.style.display="none",this.src=pathImages+"fleche_fermee.png",this.alt="masque la liste des matchs",span.innerHTML=avatar+" "+tabMessages[1])}function switchVideo(n){if(n>arrayAssoSize(scenario))return n=0,!1;{idVideo=n,video=scenario[n-1],idVideoOn=n,actions=eval(video[0].variable),listeEvents("events",media_events),setInterval(update_properties,200);let hauteur=0,matchWCalcule=0;if(isDefineBVideoJS)myVideo.src({src:pathVideos+video[0].fichier,type:"video/mp4"}),myVideo.poster(pathVideos+video[0].poster);else{questionsFaites.splice(0,questionsFaites.length),replaysFaits.splice(0,replaysFaits.length);let match=document.querySelector("match"),carousel=document.querySelector("carousel");hauteur=match.offsetHeight+carousel.offsetHeight,matchWCalcule=1.75*hauteur,myVideo=videojs("myVideo",{disableVideoPlayPauseClick:!0,width:matchWCalcule,height:hauteur,controls:!0,preload:"none",loop:!1,fluid:!0,poster:pathVideos+video[0].poster||pathImages+"pelouses/pelousemini.png",controlBar:{volumePanel:{inline:!1,vertical:!0},pictureInPictureToggle:!1},sources:[{src:pathVideos+video[0].fichier,type:"video/mp4"}],zoom:{lab:"1x",val:1},plugins:{brand:{image:pathImages+"isamini.png",title:"Arrêt sur image!",destination:"asi.html",destinationTarget:"_blank",width:20,height:20},videoJsZoom:{default:!0,dynamicLabel:!0,niveaux:[{lab:"2.5x",val:2.5},{lab:"2x",val:2},{lab:"1.5x",val:1.5},{lab:"1x",val:1}]},bug:[{type:"pict",id:"vjs-bug-pictEquipeA",visibility:!0,height:30,width:30,imgSrc:pathImages+"fanions/"+(video[0].gauche.fanion||"fff.png"),alt:video[0].gauche.nom||"fanion par défaut",link:video[0].gauche.site,opacity:.7,left:"20px",top:"20px",position:"tl"},{type:"text",id:"vjs-bug-titreEquipeA",visibility:!0,libelle:"<span>"+video[0].gauche.nom+"</span>",classeCSS:"vjs-bug-titreEquipBug",opacity:1,left:"55px",top:"25px",position:"tl"},{type:"canvas",id:"vjs-bug-silhEquipeA",visibility:!0,height:30,width:30,classeCSS:"vjs-bug-silhEquipBug",opacity:1,left:"215px",top:"20px",position:"tl"},{type:"canvas",id:"vjs-bug-silhArbitre",visibility:!0,height:30,width:30,classeCSS:"vjs-bug-silhArbitreBug",opacity:1,left:"415px",top:"20px",position:"tc"},{type:"text",id:"vjs-bug-titreArbitre",visibility:!0,libelle:"<span>"+avatar+"</span>",classeCSS:"vjs-bug-titreArbitre",opacity:1,left:"415px",top:"50px",position:"tr"},{type:"canvas",id:"vjs-bug-silhEquipeB",visibility:!0,height:30,width:30,classeCSS:"vjs-bug-silhEquipBug",opacity:1,right:"225px",top:"20px",position:"tr"},{type:"text",id:"vjs-bug-titreEquipeB",visibility:!0,libelle:"<span>"+video[0].droite.nom+"</span>",classeCSS:"vjs-bug-titreEquipBug",opacity:1,right:"55px",top:"25px",position:"tr"},{type:"pict",id:"vjs-bug-pictEquipeB",visibility:!0,height:30,width:30,imgSrc:pathImages+"fanions/"+(video[0].droite.fanion||"fff.png"),alt:video[0].droite.nom||"fanion par défaut",link:video[0].droite.site,opacity:.7,right:"20px",top:"20px",position:"tr"}]}})}numQuestion=0,isDefineBVideoJS=!0,myVideo.load();let inter=document.getElementById("inter");inter.offsetHeight,inter.style.display="flex",gestionCamps(1),showContent(!0),gestionInter("selectVideo")}}function listeEvents(id,arrayEventDef){for(let key in arrayEventDef)document._video.addEventListener(key,capture,!1);var e_loadstart;if(document.getElementById("e_loadstart"))for(let key in arrayEventDef){var elt;document.getElementById("e_"+key).textContent="0"}else{var tbody=document.getElementById(id),i=1,tr=null;for(let key in arrayEventDef){null==tr&&(tr=document.createElement("tr")).setAttribute("style","color:midnightblue");var th=document.createElement("th");th.textContent=key;var td=document.createElement("td");td.setAttribute("id","e_"+key),td.textContent="0",td.className="false",tr.appendChild(th),tr.appendChild(td),i++%5==0&&(tbody.appendChild(tr),tr=null)}null!=tr&&tbody.appendChild(tr)}}function capture(event){if("timeupdate"===event.type){var seq=Math.trunc(document._video.currentTime);if(seq!==seqUsed)if(seqUsed=seq,seq<oldStep);else{timeCode=convertInTimeCode(seq);var asWork=arrayAssoSearch(actions,timeCode);if(asWork>-1)switch(actions[asWork].act){case"Question":case"Bonus":case"Information":case"AllerA":actions[asWork].niveau===nbQuests[niveauQuest].niv&&mesActions[actions[asWork].act](asWork);break;case"Fin":case"Mitemps":mesActions[actions[asWork].act](asWork)}}media_events.currentTime=seq,media_events.playing=1}else media_events.playing=0;media_events[event.type]++,oldStep=seq}function update_properties(){for(let key in media_events){var e=document.getElementById("e_"+key);e&&(e.textContent=media_events[key],media_events[key]>0&&(e.className="true"))}}function getVideo(){return document._video}function gestionCamps(mitemps){2===mitemps&&(document.getElementById("vjs-bug-titreEquipeA").innerHTML="<span>"+video[0].droite.nom+"</span>",document.getElementById("vjs-bug-titreEquipeB").innerHTML="<span>"+video[0].gauche.nom+"</span>",document.getElementById("vjs-bug-pictEquipeA").setAttribute("src",pathImages+"fanions/"+(video[0].droite.fanion||"fff.png")),document.getElementById("vjs-bug-pictEquipeB").setAttribute("src",pathImages+"fanions/"+(video[0].gauche.fanion||"fff.png")),draw("vjs-bug-silhEquipeA",video[0].droite.maillotCouleur),draw("vjs-bug-silhEquipeB",video[0].gauche.maillotCouleur))}function showContent(etat){let carousel=document.getElementById("carousel"),myVideo=document.getElementById("myVideo"),bascule_img,bascule_titre;carousel.style.display=!0===etat?"none":"flex",document.querySelector("bascule img").setAttribute("src",pathImages+(!0===etat?"fleche_fermee.png":"fleche_ouverte.png")),document.querySelector("bascule span").innerHTML=avatar+" "+(!0===etat?tabMessages[1]:tabMessages[0]),myVideo.style.visibility="visible",myVideo.classList.add("cadre")}function scanQuestion(){nbQuests[1].nb=0,nbQuests[2].nb=0,nbQuests[3].nb=0,nbQuests[1].points=0,nbQuests[2].points=0,nbQuests[3].points=0;let niv=0;for(let ind=0;ind<arrayAssoSize(actions);ind++)if("Question"===actions[ind].act){switch(actions[ind].niveau){case"DEBUTANT":niv=1;break;case"CONFIRME":niv=2;break;case"EXPERT":niv=3;break;default:niv=0}nbQuests[niv].nb++,nbQuests[niv].points+=actions[ind].reponse.points}return document.getElementById("level1").style.display=nbQuests[1].nb>0?"flex":"none",document.getElementById("level2").style.display=nbQuests[2].nb>0?"flex":"none",document.getElementById("level3").style.display=nbQuests[3].nb>0?"flex":"none",nbQuests}document.addEventListener("DOMContentLoaded",init,!1),document.addEventListener("click",central,!1);var mesActions={Question:function(ind){document._video.pause(),gestionInter("InterQuestion",actionEnCours=actions[ind])},Bonus:function(ind){document._video.pause(),gestionInter("InterBonus",actionEnCours=actions[ind])},Information:function(ind){"but"===(actionEnCours=actions[ind]).type&&playSound("goal"),gestionInter("InterInformation",actionEnCours)},AllerA:function(ind){allerA((actionEnCours=actions[ind]).indice)},Fin:function(ind){gestionInter("Termine",actionEnCours=actions[ind])},Mitemps:function(ind){actionEnCours=actions[ind],gestionCamps(2)}};function convertInSeqCode(myTimeCode){var seqTab=myTimeCode.split(":"),seq=3600*parseFloat(seqTab[0]);return seq+=60*parseFloat(seqTab[1]),seq+=parseFloat(seqTab[2])}function continuer2(){document.querySelector("inter suite next img").style.display="none","Question"===actionEnCours.act&&(numQuestion++,gestJauge()),document._video.playbackRate=1,document._video.volume=volumeLevel,classId("del","myVideo","vjs-blurOn"),classId("add","myVideo","vjs-blurOff"),document._video.play(),void 0!==actionEnCours.saut?timeOut=setTimeout(gestionInter,1500*actionEnCours.saut.attente,"FermeInfo",actionEnCours):gestionInter("FermeInfo",actionEnCours)}function fProposition(reponse){let bonneReponse=actionEnCours.reponse.solution;bonneReponse===reponse?(playSound("bonne"),classId("add","proposition"+reponse,"green"),questionsFaites.indexOf(actionEnCours.step)<0&&(addScore(actionEnCours.reponse.points),questionsFaites.push(actionEnCours.step))):(playSound("mauvaise"),classId("add","proposition"+reponse,"rouge"),classId("add","proposition"+bonneReponse,"green")),document.getElementById("loi"+bonneReponse).style.display="flex",gestPropositions("bloquer",actionEnCours.attributs),gestionInter("reponse",actionEnCours)}function allerA(indice){timeOutEffet=setTimeout(endTimeOut,500,indice),classId("del","myVideo","vjs-blurOff"),classId("add","myVideo","vjs-blurOn")}function endTimeOut(indice){getVideo().currentTime=convertInSeqCode(indice),classId("del","myVideo","vjs-blurOn"),classId("add","myVideo","vjs-blurOff"),clearTimeout(timeOutEffet)}function gestJauge(){let pourCent=0,jauge=document.getElementsByClassName("progress-bar");0==numQuestion?(jauge[0].setAttribute("aria-valuenow",0),jauge[0].setAttribute("style","width: 0%"),jauge[0].innerHTML=nbQuests[niveauQuest].nb+" Question"+(nbQuests[niveauQuest].nb>1?"s":"")):(jauge[0].setAttribute("aria-valuenow",numQuestion),pourCent=numQuestion/nbQuests[niveauQuest].nb*100,jauge[0].setAttribute("style","width: "+pourCent+"%"),jauge[0].innerHTML=numQuestion)}function fReplay(param){addScore(-1),replaysFaits.push(actionEnCours.step),getVideo().currentTime=getVideo().currentTime-param,document._video.playbackRate=.2,volumeLevel=document._video.volume,document._video.volume=0,classId("del","myVideo","vjs-blurOn"),classId("add","myVideo","vjs-blurOff"),document._video.play()}function addScore(value){0===value?videoNbPoint=0:videoNbPoint+=value;var score=("0"+videoNbPoint.toString()).substr(-2),scoreMax=("0"+nbQuests[niveauQuest].points.toString()).substr(-2);let myColor,myScore='<span style="color:'+(videoNbPoint/nbQuests[niveauQuest].points>.5?"green":"black")+';">'+score+"</span>";document.querySelector("inter suite score p").innerHTML=myScore+":"+scoreMax}function convertInTimeCode(myStep){var step=myStep,heures=Math.trunc(step/3600);step-=3600*heures;var minutes=Math.trunc(step/60),secondes=Math.trunc(step-60*minutes);return timeCode=("0"+heures).substr(-2)+":"+("0"+minutes).substr(-2)+":"+("0"+secondes).substr(-2)}function fNiveaux(level,idVideo){clearTimeout(timeOutEffet),niveauQuest=level,switchVideo(idVideo)}function gestNiveaux(idVideo){deleteChild("inter tete niveau button");let button=document.querySelector("inter tete niveau button"),span=document.createElement("span");for(let i=0;i<3;i++)span.id="level"+(i+1),span.className=i+1===niveauQuest?"badge badge-current badge-light":"badge badge-light",span.setAttribute("onclick","fNiveaux("+(i+1)+","+idVideo+");"),span.setAttribute("title",nbQuests[i+1].niv),span.setAttribute("alt",nbQuests[i+1].niv),span.innerHTML=i+1,button.appendChild(span),span=document.createElement("span")}function gestPropositions(etape,attributs,reponse){let propositions=document.querySelector("inter propositions"),proposition=document.createElement("proposition"),loi=document.createElement("a"),i=document.createElement("i"),button=document.createElement("button");switch(etape){case"afficher":deleteChild("inter propositions");for(let i=0;i<attributs.length;i++)proposition.id="proposition-div-"+(i+1),loi.id="loi"+(i+1),void 0!==actionEnCours.reponse.loi?(loi.href="../lois/"+actionEnCours.reponse.loi+".pdf",loi.target="_blank",i.id="book"+(i+1),i.className="fas fa-book",loi.innerHTML='<i class="fas fa-book"></i>'):loi.innerHTML="",loi.setAttribute("style","display:none"),proposition.appendChild(loi),button.id="proposition"+(i+1),button.className="btn btn-warning",button.innerHTML=attributs[i],questionsFaites.indexOf(actionEnCours.step)<0&&button.setAttribute("onclick","fProposition("+(i+1)+");"),proposition.appendChild(button),propositions.appendChild(proposition),button=document.createElement("button"),loi=document.createElement("a"),proposition=document.createElement("proposition");document.querySelector("inter complement p").innerHTML=reponse.libelle;break;case"bloquer":for(let i=0;i<attributs.length;i++)document.getElementById("proposition"+(i+1)).removeAttribute("onClick")}}function gestionInter(etape,objet){let inter=document.querySelector("inter");switch(etape){case"selectVideo":document.querySelector("inter jauge div").style.display="flex",document.querySelector("inter tete titre p").innerHTML="Match",document.querySelector("inter tete points").style.display="none",gestNiveaux(idVideoOn),scanQuestion(),gestJauge(),document.querySelector("inter question p").style.display="flex",document.querySelector("inter question p").innerHTML=video[0].description,document.querySelector("inter propositions").style.display="none",document.querySelector("inter complement").style.display="flex",document.querySelector("inter complement p").innerHTML=tabMessages[2]+(nbQuests[niveauQuest].nb>1?"des questions":"une question")+" de niveau "+nbQuests[niveauQuest].niv+".<br><br>"+tabMessages[3],document.querySelector("inter complement img").style.display="none",document.querySelector("inter suite replay span").style.display="none",document.querySelector("inter suite score p").style.display="none",addScore(0),document.querySelector("inter suite next img").style.display="none";break;case"FermeInfo":document.querySelector("inter tete titre p").innerHTML="Match",document.querySelector("inter tete points").style.display="none",document.querySelector("inter question p").style.display="none",document.querySelector("inter propositions").style.display="none",document.querySelector("inter complement").style.display="none",document.querySelector("inter suite replay span").style.display="none",document.querySelector("inter suite score p").style.display="flex",allerA(objet.saut.indice);break;case"InterQuestion":document.querySelector("inter tete titre p").innerHTML=objet.act,document.querySelector("inter tete points").style.display="flex",classSelector("set","inter tete points p",objet.act),document.querySelector("inter tete points p").innerHTML="0"+objet.reponse.points,gestJauge(),document.querySelector("inter question p").style.display="flex",document.querySelector("inter question p").innerHTML=objet.question.libelle,gestPropositions("afficher",objet.attributs,objet.reponse),document.querySelector("inter propositions").style.display="flex",document.querySelector("inter complement").style.display="none",replaysFaits.indexOf(objet.step)<0?(document.querySelector("inter suite replay span").style.display=objet.question.reculReplay?"flex":"none",document.querySelector("inter suite replay span").innerHTML=objet.question.reculReplay,document.querySelector("inter suite replay span").setAttribute("onclick","fReplay("+objet.question.reculReplay+");")):document.querySelector("inter suite replay span").style.display="none",document.querySelector("inter suite score p").style.display="flex",document.querySelector("inter suite next img").style.display="none";break;case"InterBonus":document.querySelector("inter tete titre p").innerHTML=objet.act,document.querySelector("inter tete points").style.display="flex",classSelector("set","inter tete points p",objet.act),document.querySelector("inter tete points p").innerHTML="0"+objet.reponse.points,document.querySelector("inter question p").style.display="flex",document.querySelector("inter question p").innerHTML=objet.question.libelle,gestPropositions("afficher",objet.attributs,objet.reponse),document.querySelector("inter propositions").style.display="flex",document.querySelector("inter complement").style.display="none",document.querySelector("inter suite replay span").style.display="none",document.querySelector("inter suite score p").style.display="flex",document.querySelector("inter suite next img").style.display="none";break;case"InterInformation":document.querySelector("inter tete titre p").innerHTML=objet.act,document.querySelector("inter tete points").style.display="none",document.querySelector("inter question p").style.display="flex",document.querySelector("inter question p").innerHTML=objet.libelle,document.querySelector("inter propositions").style.display="none",document.querySelector("inter complement").style.display="none",document.querySelector("inter suite replay span").style.display="none",document.querySelector("inter suite score p").style.display="flex",document.querySelector("inter suite next img").style.display="none",timeOut=setTimeout(gestionInter,1e3*objet.saut.attente,"FermeInfo",objet);break;case"reponse":void 0===objet.reponse.libelle&&void 0===objet.reponse.pict?document.querySelector("inter complement").style.display="none":(document.querySelector("inter complement").style.display="flex",document.querySelector("inter complement p").style.display=void 0===objet.reponse.libelle?"none":"flex",document.querySelector("inter complement img").style.display=void 0===objet.reponse.pict?"none":"flex",void 0!==objet.reponse.pict&&document.querySelector("inter complement img").setAttribute("src",pathImages+objet.reponse.pict)),void 0!==document.querySelector("inter suite replay span")&&(document.querySelector("inter suite replay span").style.display="none"),document.querySelector("inter suite score p").style.display="flex",document.querySelector("inter suite next img").style.display="flex";break;case"Termine":document.querySelector("inter tete titre p").innerHTML="Match Terminé",document.querySelector("inter jauge div").style.display="none",document.querySelector("inter tete points").style.display="none",document.querySelector("inter question p").style.display="none",document.querySelector("inter propositions").style.display="none",document.querySelector("inter complement").style.display="flex",document.querySelector("inter complement").innerHTML=tabMessages[4]+"<br>"+tabMessages[5],document.querySelector("inter suite replay span").style.display="none",document.querySelector("inter suite score p").style.display="flex";break;default:inter.display="none"}}
>>>>>>> footer
